<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
th:replace="~{header::layout(~{::section})}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
    <section>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a href="/">
                                <img
                                  src="/images/Tekmart.png"
                                  alt="eBay Logo"
                                  width="150px"
                                  height="75px"
                                />
                              </a>
                        </li>
                        <li class="nav-item" th:each="category : ${categories}">
                            <a class="nav-link" th:href="@{'/products?category=' + ${category.name}}"
                               th:classappend="${paramValue == category.name} ? 'active' : ''">
                               [[${category.name}]]
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <th:block th:if="${session.succMsg}">
          <p
            class="text-success alert alert-success text-center"
            role="alert"
          >
            [[${session.succMsg}]]
          </p>
          <th:block
            th:text="${@commnServiceImpl.removeSessionMessage()}"
          ></th:block>
        </th:block>

        <th:block th:if="${session.errorMsg}">
          <p class="text-danger text-center alert alert-danger">
            [[${session.errorMsg}]]
          </p>
          <th:block
            th:text="${@commnServiceImpl.removeSessionMessage()}"
          ></th:block>
        </th:block>
    
        <main class="container my-5">
            <div class="row mb-4">
                <div class="col-md-8">
                    <h2 class="fw-bold" th:text="${paramValue == ''} ? 'All Products' : ${paramValue}"></h2>
                    <small class="text-muted" th:text="${paramValue == ''} ? 'All products (' + ${totalElements} + ')' : ${paramValue} + ' products (' + ${productsSize} + ')'"></small>
                </div>
                <div class="col-md-4">
                    <form class="d-flex" action="/products" method="get">
                      <div class="input-group">
                        <input
                          class="form-control"
                          type="search"
                          name="ch"
                          placeholder="Search for anything"
                          aria-label="Search"
                        />
                        <button class="btn btn-ebay">
                          <i class="bi bi-search"></i>
                        </button>
                      </div>
                    </form>
                </div>
            </div>
    
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
                <th:block th:if="${productsSize >0}">
                    <div class="col" th:each="p : ${products}">
                        <div class="card product-card">
                            <img th:src="@{'/images/product_img/' + ${p.image}}" class="card-img-top product-imagee" alt="[[${p.title}]]" width="100%" height="150px">
                            <div class="card-body">
                                <h5 class="card-title">[[${p.title}]]</h5>
                                <p class="card-text">[[${p.description}]]</p>
                                <p class="fw-bold">
                                    <span>&#8369; [[${p.discountPrice}]]</span> <br> 
                                    <span class="text-decoration-line-through text-secondary">&#8369; [[${p.price}]]</span> 
                                    <span class="fs-6 text-success">[[${p.discount}]]% off</span>
                                </p>
                            </div>
                            <div class="card-footer">
                                <div class="d-grid gap-2">
                                    <a type="button" th:href="@{'/product/' + ${p.itemId}}" class="btn btn-ebay rounded" title="View Product">View Product</a>
                                </div>
                                <div class="my-2"></div>
                                <div class="d-grid gap-2">
                                  <th:block th:if="${#lists.contains(wishlistProductIds, p.id)}">
                                      <a th:href="@{/user/wishlist/removeFromCart/{id}(id=${p.id})}" type="button" class="btn btn-outline-secondary rounded" title="Remove from Wishlist">Remove from Wishlist</a>
                                  </th:block>
                                  <th:block th:unless="${#lists.contains(wishlistProductIds, p.id)}">
                                      <a th:href="@{/user/wishlist/add/{id}(id=${p.id})}" type="button" class="btn btn-outline-secondary rounded" title="Add to Wishlist">Add to Wishlist</a>
                                  </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>
            <th:block th:unless="${productsSize>0}">
                <h1 class="text-center pb-3 my-5 text-danger">No products found</h1>
            </th:block>

            <!-- Pagination  -->
            <th:block th:if="${productsSize>0}">
              <nav aria-label="Page navigation example" class="mt-5">
                <ul class="pagination justify-content-center">
                  <li class="page-item" th:classappend="${isFirst} ? 'disabled':''"><a
                      class="page-link" th:href="@{'/products?pageNo='+${pageNo-1}}"
                      aria-label="Previous"> <span aria-hidden="true">&laquo;</span>
                    </a></li>

                  <li th:each="i:${#numbers.sequence(1,totalPages)}" class="page-item"
                    th:classappend="${pageNo+1==i}?'active':''" ]]><a class="page-link"
                      th:href="@{'/products?pageNo='+${i-1}}">[[${i}]]</a></li>

                  <li class="page-item" th:classappend="${isLast} ? 'disabled':''"><a
                      class="page-link" th:href="@{'/products?pageNo='+${pageNo+1}}"
                      aria-label="Next"> <span aria-hidden="true">&raquo;</span>
                    </a></li>
                </ul>
              </nav>
            </th:block>
        </main>
        <footer class="bg-maroon text-center text-lg-start text-white">
            <!-- Grid container -->
            <div class="container p-2">
              <!--Grid row-->
              <div class="row my-4">
                <!--Grid column-->
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                  <div
                    class="rounded-circle bg-white shadow-1-strong d-flex align-items-center justify-content-center mb-4 mx-auto"
                    style="width: 150px; height: 150px"
                  >
                    <img
                      src="/images/TekMart.svg"
                      height="140"
                      alt="Logo"
                      loading="lazy"
                    />
                  </div>
    
                  <p class="text-center">
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Nihil,
                    tempora!
                  </p>
    
                  <ul class="list-unstyled d-flex flex-row justify-content-center">
                    <li>
                      <a class="text-white px-2" href="#!">
                        <i class="bi bi-facebook"></i>
                      </a>
                    </li>
                    <li>
                      <a class="text-white px-2" href="#!">
                        <i class="bi bi-instagram"></i>
                      </a>
                    </li>
                    <li>
                      <a class="text-white ps-2" href="#!">
                        <i class="bi bi-twitter"></i>
                      </a>
                    </li>
                  </ul>
                </div>
                <!--Grid column-->
    
                <!--Grid column-->
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                  <h5 class="text-uppercase mb-4">About Us</h5>
    
                  <ul class="list-unstyled">
                    <li class="mb-2">
                      <a href="#!" class="text-white"
                        ><i class="bi bi-file-earmark-person pe-2"></i>Our Story</a
                      >
                    </li>
                    <li class="mb-2">
                      <a href="#!" class="text-white"
                        ><i class="bi bi-people pe-2"></i>Meet the Team</a
                      >
                    </li>
                  </ul>
                </div>
                <!--Grid column-->
    
                <!--Grid column-->
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                  <h5 class="text-uppercase mb-4">Customer Support</h5>
    
                  <ul class="list-unstyled">
                    <li class="mb-2">
                      <a href="#!" class="text-white"
                        ><i class="bi bi-question-square pe-2"></i></i>FAQs</a
                      >
                    </li>
                    <li class="mb-2">
                      <a href="#!" class="text-white"
                        ><i class="bi bi-chat-dots pe-2"></i>Contact Us</a
                      >
                    </li>
                    <li class="mb-2">
                      <a href="#!" class="text-white"
                        ><i class="bi bi-envelope pe-2"></i>Email Support</a
                      >
                    </li>
                  </ul>
                </div>
                <!--Grid column-->
    
                <!--Grid column-->
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                  <h5 class="text-uppercase mb-4">Contact Us</h5>
    
                  <ul class="list-unstyled">
                    <li>
                      <p>
                        <i class="bi bi-window pe-2"></i>
                        TeknoyMart Inc.
                      </p>
                    </li>
                    <li>
                      <p><i class="bi bi-phone pe-2"></i>+639982020869</p>
                    </li>
                    <li>
                      <p>
                        <i class="bi bi-envelope pe-2"></i>teknoymart@wp.pl
                      </p>
                    </li>
                  </ul>
                </div>
                <!--Grid column-->
              </div>
              <!--Grid row-->
            </div>
            <!-- Grid container -->
        </footer>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>